<Page
    x:Class="AIOneUWPCX.MainPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="using:AIOneUWPCX"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    mc:Ignorable="d"
	d:DesignHeight="484" d:DesignWidth="1152">
	<Page.Background>
		<AcrylicBrush BackgroundSource="HostBackdrop"
                      TintColor="Black"
                      TintOpacity="0.6"
                      FallbackColor="Transparent"/>
	</Page.Background>

	<Grid Margin="10">
		<Grid.ColumnDefinitions>
			<ColumnDefinition Width="*"/>
		</Grid.ColumnDefinitions>
		<Grid.RowDefinitions>
			<RowDefinition Height="Auto"/>
			<RowDefinition Height="10"/>
			<RowDefinition Height="*"/>
		</Grid.RowDefinitions>
		<Grid>
			<Grid.RowDefinitions>
				<RowDefinition Height="Auto"/>
				<RowDefinition Height="Auto"/>
			</Grid.RowDefinitions>
			<Button HorizontalAlignment="Stretch" Click="LoadModelButton_Click">Load model</Button>
			<ProgressBar x:Name="ModelProgressBar" Grid.Row="1" Value="0" Maximum="100" Visibility="Collapsed"/>
		</Grid>
		<ContentControl x:Name="MessageControl" Grid.Row="2" IsEnabled="False" VerticalContentAlignment="Stretch" HorizontalContentAlignment="Stretch">
			<Grid>
				<Grid.RowDefinitions>
					<RowDefinition Height="*"/>
					<RowDefinition Height="10"/>
					<RowDefinition Height="Auto"/>
				</Grid.RowDefinitions>

				<ListView ItemsSource="{x:Bind Messages, Mode=OneWay}" SelectionMode="None">
					<ListView.ItemTemplate>
						<DataTemplate x:DataType="local:MessageItem">
							<StackPanel>
								<TextBlock Text="{x:Bind Role, Mode=OneWay}" Margin="0,5,5,0" FontWeight="Bold" FontSize="14" />
								<ToggleButton x:Name="ExpandButton" FontWeight="SemiBold" Background="Transparent" Visibility="{x:Bind HasThought, Mode=OneWay}">
									<StackPanel Orientation="Horizontal" VerticalAlignment="Center">
										<TextBlock Text="▶ Reasoning" Margin="0,0,5,0"/>
										<ProgressRing Width="16" Height="16" IsActive="{x:Bind IsReasoning, Mode=OneWay}"/>
									</StackPanel>
								</ToggleButton>
								<StackPanel Margin="10,0,0,0" Visibility="{Binding IsChecked, ElementName=ExpandButton}">
									<TextBlock Text="{x:Bind Thoughts, Mode=OneWay}" TextWrapping="Wrap"/>
								</StackPanel>
								<TextBlock Text="{x:Bind Text, Mode=OneWay}" Margin="5,0,5,5" TextWrapping="Wrap"/>
							</StackPanel>
						</DataTemplate>
					</ListView.ItemTemplate>
				</ListView>
				<Grid Grid.Row="2">
					<Grid.ColumnDefinitions>
						<ColumnDefinition Width="*"/>
						<ColumnDefinition Width="10"/>
						<ColumnDefinition Width="Auto"/>
					</Grid.ColumnDefinitions>
					<TextBox x:Name="MessageInput" Grid.Column="0" KeyDown="InputTextBox_KeyDown"></TextBox>
					<Button Grid.Column="2" Click="SendButton_Click">Send</Button>
				</Grid>
			</Grid>
		</ContentControl>
	</Grid>
</Page>
